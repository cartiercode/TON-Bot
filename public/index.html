<!DOCTYPE html>
<html>
<head>
  <title>JANE Wallet</title>
</head>
<body>
  <h1>JANE Wallet</h1>
  <button onclick="createWallet()">Create Wallet (50 Stars)</button>
  <div id="walletStatus"></div>
  <button onclick="setPin()" style="display:none;" id="setPinButton">Set PIN for Security</button>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script>
    async function createWallet() {
      const user = window.Telegram.WebApp.initDataUnsafe.user;
      const userId = user.id;
      // No password needed - use a placeholder encryptedKey or skip it
      const encryptedKey = btoa(userId + Date.now()); // Temp key, adjust as needed

      // Send payment request to bot
      window.Telegram.WebApp.sendData(JSON.stringify({
        action: 'pay',
        userId: userId,
        encryptedKey: encryptedKey
      }));

      // Update UI
      document.getElementById('walletStatus').innerText = 'Processing payment...';
    }

    async function setPin() {
      const pin = prompt('Enter a 4-digit PIN for wallet security:');
      if (pin && pin.length === 4 && !isNaN(pin)) {
        // Placeholder - save PIN later (e.g., localStorage or server-side)
        alert('PIN set successfully! (Feature coming soon)');
      } else {
        alert('Please enter a valid 4-digit PIN');
      }
    }

    // Show Set PIN button after wallet creation (simplified for now)
    window.Telegram.WebApp.onEvent('invoiceClosed', (data) => {
      if (data.status === 'paid') {
        document.getElementById('walletStatus').innerText = 'Wallet created!';
        document.getElementById('setPinButton').style.display = 'block';
      }
    });
  </script>
</body>
</html>
